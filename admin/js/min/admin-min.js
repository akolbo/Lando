/*
Title:				Admin Panel JavaScript
Author:				Sam Rayner - http://samrayner.com
Created:			2011-09-16
*/var PageNav={sortableTree:function(a){var b={};for(var c=0;c<a.length;c++){var d=a[c];b[d]=PageNav.sortableTree($("#"+d+" > .sortable").sortable("toArray"));$("#"+d+" > * > input:checked").length||(b[d]._hidden=!0)}return b},updateOrder:function(){var a=$("#page-list > ol").sortable("toArray"),b=PageNav.sortableTree(a);$("#page_order").val(JSON.stringify(b))},updateVisibility:function(a){var b=a.target.checked;$(this).closest("li").find("* * input:checkbox").each(function(){if(!b)$(this).attr("disabled",!0);else{var a=$(this).closest("li").parentsUntil($("#page-list"),"li"),c=a.children("div").children("input:not([checked])").length;c||$(this).removeAttr("disabled")}});PageNav.updateOrder()},labelTap:function(){var a=$("#".$(this).attr("for")),b=a.checked;b?a.removeAttr("checked"):a.attr("checked",1)},init:function(){$("#page-list input:checkbox").change(PageNav.updateVisibility);$("#page-list label").click(PageNav.labelTap);$("#page-list > ol").disableSelection();$(".sortable").sortable({update:PageNav.updateOrder});$(".sortable input:checkbox").change()}},Tooltips={toggle:function(a){var b=$(a);b.toggleClass("collapsed")},init:function(){$("#pretty_urls").change(function(){Tooltips.toggle("#htaccess")});$("#cache_on_load").change(function(){Tooltips.toggle("#cron-job")})}},Recache={types:["pages","posts","drafts","collections","snippets"],done:function(){$("#recache-button").removeClass("active").html("Cache refresh complete")},updateProgress:function(a){$("#recache-button").html("Caching "+a+"&hellip;")},process:function(a){var b=Recache.types.indexOf(a);b>=0&&Recache.updateProgress(a);var c=$.ajax({url:"update/index.php",data:{type:a},complete:function(){b>=0&&(b+1==Recache.types.length?Recache.done():Recache.process(Recache.types[b+1]))}})},click:function(a){a.preventDefault();$(this).addClass("active");Recache.process("files");Recache.process(Recache.types[0])},init:function(){$("#recache-button").click(Recache.click)}},FormCheck={required:function(a){var b=$(this).find("input[required]").filter(function(){return $(this).val().trim()===""});$.each(b,function(){$(this).addClass("highlight")});if(b.length>0){b[0].focus();a.preventDefault();return!1}},verifyPass:function(a){if($("#admin_password").val()!=$("#confirm_pass").val()){window.alert("The passwords you entered don't match, please type them again.");$("#admin_password").val("").addClass("highlight").focus();$("#confirm_pass").val("").addClass("highlight");a.preventDefault();return!1}},init:function(){$("form").submit(FormCheck.required);$("form").submit(FormCheck.verifyPass)}};$(function(){Tooltips.init();FormCheck.init();$("#page-list").length&&PageNav.init();$("#recache-button").length&&Recache.init()});